{"version":3,"sources":["../src/swizzle-config.js"],"names":["files","params","stacks","conf","keyCase","text","toUpperCase","descCase","toLowerCase","replace","defaultConf","rc","filePath","SwizzleConfig","swizzleJson","state","Object","assign","actions","addFiles","removeFiles","name","desc","defaultValue","generated","description","addParam","removeParam","file","addStack","removeStack","verbose","reduce","list","param","push","keys","stackName","filter","d","map","type","TypeError","action","concat","find","findFile","existingParam","newParam"],"mappings":"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","file":"swizzle-config.js","sourcesContent":["import snakeCase from 'lodash.snakecase'\nimport unique from 'lodash.uniq'\nimport omit from 'lodash.omit'\n\n/**\n no file system operations, state changes only\n **/\n\nexport const keyCase = (text) => snakeCase(text).toUpperCase()\nexport const descCase = (text) => snakeCase(text).toLowerCase().replace(/_/g, ' ')\n\nexport const defaultConf = () => ({\n\trc: {},\n\tfiles: [],\n\tparams: [],\n\tstacks: {},\n\tfilePath: './swizzle.json'\n})\n\nexport class SwizzleConfig {\n\n\tconstructor(swizzleJson) {\n\t\tthis.state = Object.assign(defaultConf(), swizzleJson)\n\t}\n\n\tget stackName() {\n\t\treturn this.state.stackName\n\t}\n\n\tset stackName(name) {\n\t\tthis.state.stackName = name\n\t}\n\n\tget files() {\n\t\treturn this.state.files.filter((d) => d)\n\t}\n\n\tget params() {\n\t\treturn this.state.params.map((param) => Object.assign({}, param))\n\t}\n\n\taddFiles({files}) {\n\t\tthis.state = conf(this.state, actions.addFiles(files))\n\t}\n\n\tremoveFiles({files}) {\n\t\tthis.state = conf(this.state, actions.removeFiles(files))\n\t}\n\n\taddParam({name, desc, defaultValue, generated, description}) {\n\t\t// support short or long name as a convenience\n\t\tdescription = description || desc\n\t\tthis.state = conf(this.state, actions.addParam(name, description, defaultValue, generated))\n\t}\n\n\tremoveParam({name}) {\n\t\tthis.state = conf(this.state, actions.removeParam(name))\n\t}\n\n\taddStack({name, params, file}) {\n\t\tthis.state = conf(this.state, actions.addStack(name, params, file))\n\t}\n\n\tremoveStack({name}) {\n\t\tthis.state = conf(this.state, actions.removeStack(name))\n\t}\n\n\tlistParams({verbose} = {verbose: false}) {\n\t\treturn this.state.params.reduce((list, param) => {\n\t\t\tif (verbose) {\n\t\t\t\tlist.push({name: param.name, description: param.description, defaultValue: param.defaultValue})\n\t\t\t} else {\n\t\t\t\tlist.push(param.name)\n\t\t\t}\n\t\t\treturn list\n\t\t}, [])\n\t}\n\n\tlistStacks({verbose} = {verbose: false}) {\n\t\treturn Object.keys(this.state.stacks).reduce((list, name) => {\n\t\t\tif (verbose) {\n\t\t\t\tlist.push(Object.assign({}, this.state.stacks[name]))\n\t\t\t} else {\n\t\t\t\tlist.push(name)\n\t\t\t}\n\t\t\treturn list\n\t\t}, [])\n\t}\n\n}\n\nconst actions = {\n\taddFiles(files) {\n\t\treturn {\n\t\t\ttype: 'add-files',\n\t\t\tfiles\n\t\t}\n\t},\n\tremoveFiles(files) {\n\t\treturn {\n\t\t\ttype: 'remove-files',\n\t\t\tfiles\n\t\t}\n\t},\n\taddParam(name, description, defaultValue, generated) {\n\t\tif (!name) {\n\t\t\tthrow new TypeError('a parameter name is required')\n\t\t}\n\t\treturn {\n\t\t\ttype: 'add-param',\n\t\t\tparam: {\n\t\t\t\tname,\n\t\t\t\tdescription,\n\t\t\t\tdefaultValue,\n\t\t\t\tgenerated\n\t\t\t}\n\t\t}\n\t},\n\tremoveParam(name) {\n\t\treturn {\n\t\t\ttype: 'remove-param',\n\t\t\tname\n\t\t}\n\t},\n\taddStack(name, params, file) {\n\t\treturn {\n\t\t\ttype: 'add-stack',\n\t\t\tname,\n\t\t\tparams,\n\t\t\tfile\n\t\t}\n\t},\n\tremoveStack(name) {\n\t\treturn {\n\t\t\ttype: 'remove-stack',\n\t\t\tname\n\t\t}\n\t}\n}\n\nexport function files(state = [], action) {\n\tswitch (action.type) {\n\t\tcase 'add-files':\n\t\t\treturn unique(state.concat(action.files))\n\t\tcase 'remove-files':\n\t\t\treturn state.filter((file) => !action.files.find((findFile) => file === findFile))\n\t}\n\treturn state\n}\n\nexport function params(state = [], action) {\n\n\tswitch (action.type) {\n\n\t\tcase 'add-param':\n\t\t\tconst existingParam = state.find((d) => d.name === action.param.name)\n\t\t\tconst {name, description, defaultValue, generated} = action.param\n\t\t\tconst newParam = {}\n\t\t\tif (existingParam) {\n\t\t\t\t// update an existing parameter\n\t\t\t\tObject.assign(newParam, existingParam)\n\t\t\t\tif (typeof description !== 'undefined') {\n\t\t\t\t\tnewParam.description = description\n\t\t\t\t}\n\t\t\t\tif (typeof defaultValue !== 'undefined') {\n\t\t\t\t\tnewParam.defaultValue = defaultValue\n\t\t\t\t}\n\t\t\t\tif (typeof generated !== 'undefined') {\n\t\t\t\t\tnewParam.generated = generated\n\t\t\t\t}\n\t\t\t\tif (newParam.generated !== true) {\n\t\t\t\t\tdelete newParam.generated\n\t\t\t\t}\n\t\t\t\treturn state.map((param) => {\n\t\t\t\t\tif (param.name === name) {\n\t\t\t\t\t\treturn newParam\n\t\t\t\t\t}\n\t\t\t\t\treturn param\n\t\t\t\t})\n\t\t\t}\n\t\t\t// adding a new parameter\n\t\t\tObject.assign(newParam, {name, description, defaultValue, generated})\n\t\t\tif (typeof newParam.description === 'undefined') {\n\t\t\t\tnewParam.description = descCase(`Your-${action.param.name}`)\n\t\t\t}\n\t\t\tif (typeof newParam.defaultValue === 'undefined') {\n\t\t\t\tif (newParam.generated === true) {\n\t\t\t\t\tnewParam.defaultValue = 'generated'\n\t\t\t\t} else {\n\t\t\t\t\tnewParam.defaultValue = keyCase(`Your-${action.param.name}`)\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (newParam.generated !== true) {\n\t\t\t\tdelete newParam.generated\n\t\t\t}\n\t\t\treturn state.concat(newParam)\n\n\t\tcase 'remove-param':\n\t\t\treturn state.filter((d) => d.name !== action.name)\n\n\t\tdefault:\n\t\t\treturn state\n\t}\n\n}\n\nexport function stacks(state = [], action) {\n\tswitch (action.type) {\n\t\tcase 'add-stack':\n\t\t\treturn Object.assign({}, state, {[action.name]: {params: action.params, file: action.file || ''}})\n\t\tcase 'remove-stack':\n\t\t\treturn omit(state, action.name)\n\t}\n\treturn state\n}\n\nexport function conf(state = defaultConf(), action) {\n\tswitch (action.type) {\n\t\tcase 'add-files':\n\t\tcase 'remove-files':\n\t\t\treturn Object.assign(state, {files: files(state.files, action)})\n\t\tcase 'add-param':\n\t\tcase 'remove-param':\n\t\t\treturn Object.assign(state, {params: params(state.params, action)})\n\t\tcase 'add-stack':\n\t\tcase 'remove-stack':\n\t\t\treturn Object.assign(state, {stacks: stacks(state.stacks, action)})\n\t}\n\treturn state\n}\n"]}